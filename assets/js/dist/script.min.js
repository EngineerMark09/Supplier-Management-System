"use strict";$(document).ready(function(){function t(d){var r="#suppliers-table"===d?$("#search-input").val().toLowerCase():$("#search-input-suppliers").val().toLowerCase(),l="#suppliers-table"===d?$("#status-filter").val():$("#status-filter-suppliers").val();$(d+" tbody tr").filter(function(){var t,e=$(this).find("td:nth-child(2)").text().toLowerCase(),a=$(this).find("td:nth-child(3)").text().toLowerCase(),s=$(this).find("td:nth-child(4)").text().toLowerCase(),n=$(this).find("td:nth-child(5)").text().toLowerCase(),i="";t="#suppliers-table-tab"===d?(i=$(this).find("td:nth-child(6)").text().toLowerCase(),$(this).find("td:nth-child(7)").text()):$(this).find("td:nth-child(6)").text();var c=""===r||-1<e.indexOf(r)||-1<a.indexOf(r)||-1<s.indexOf(r)||-1<n.indexOf(r)||-1<i.indexOf(r)||-1<t.toLowerCase().indexOf(r),o=""===l||t===l;$(this).toggle(c&&o)})}function e(){$("#modal-title").text("Add Supplier"),$("#supplier-form")[0].reset(),$("#supplier_id").val(""),$("#status").val("Active"),$("#supplier-modal").css("display","flex")}function n(){$.ajax({url:"api/read.php",type:"GET",dataType:"json",success:function(t){var s="";if(0<t.length){$("#total-suppliers").text(t.length);var e=t.filter(function(t){return"Active"===(t.status||"Active")}).length;$("#active-suppliers").text(e),$.each(t,function(t,e){var a=o(e.status||"Active");s+="<tr>\n                            <td>".concat(e.id,"</td>\n                            <td>").concat(e.company_name,"</td>\n                            <td>").concat(e.contact_person,"</td>\n                            <td>").concat(e.email,"</td>\n                            <td>").concat(e.phone,"</td>\n                            <td>").concat(a,'</td>\n                            <td>\n                                <button class="btn-sm btn-edit" data-id="').concat(e.id,'"><i class="fa-solid fa-pen"></i></button>\n                                <button class="btn-sm btn-delete" data-id="').concat(e.id,'"><i class="fa-solid fa-trash"></i></button>\n                            </td>\n                        </tr>')})}else $("#total-suppliers").text("0"),$("#active-suppliers").text("0"),s='<tr><td colspan="7" style="text-align:center">No suppliers found.</td></tr>';$("#suppliers-table tbody").html(s)},error:function(){$("#suppliers-table tbody").html('<tr><td colspan="7" style="text-align:center; color:red;">Error loading data. Check database connection.</td></tr>')}})}function i(){$.ajax({url:"api/read.php",type:"GET",dataType:"json",success:function(t){var s="";0<t.length?$.each(t,function(t,e){var a=o(e.status||"Active");s+="<tr>\n                            <td>".concat(e.id,"</td>\n                            <td>").concat(e.company_name,"</td>\n                            <td>").concat(e.contact_person,"</td>\n                            <td>").concat(e.email,"</td>\n                            <td>").concat(e.phone,"</td>\n                            <td>").concat(e.address,"</td>\n                            <td>").concat(a,'</td>\n                            <td>\n                                <button class="btn-sm btn-edit" data-id="').concat(e.id,'"><i class="fa-solid fa-pen"></i></button>\n                                <button class="btn-sm btn-delete" data-id="').concat(e.id,'"><i class="fa-solid fa-trash"></i></button>\n                            </td>\n                        </tr>')}):s='<tr><td colspan="8" style="text-align:center">No suppliers found.</td></tr>',$("#suppliers-table-tab tbody").html(s)},error:function(){$("#suppliers-table-tab tbody").html('<tr><td colspan="8" style="text-align:center; color:red;">Error loading data. Check database connection.</td></tr>')}})}function c(t,e){var a=$("#alert-message");a.removeClass("alert-success alert-error").addClass("success"===t?"alert-success":"alert-error"),a.text(e).fadeIn(),setTimeout(function(){a.fadeOut()},3e3)}function o(t){var e="badge-success";return"Inactive"===t?e="badge-secondary":"Suspended"===t&&(e="badge-danger"),'<span class="badge '.concat(e,'">').concat(t,"</span>")}n(),i(),$(".nav-link[data-tab]").click(function(t){t.preventDefault();var e=$(this).data("tab");$(".nav-link").removeClass("active"),$(this).addClass("active"),$(".tab-content").removeClass("active"),$("#tab-"+e).addClass("active");$("#page-title").text({dashboard:"Dashboard",suppliers:"Supplier Management",settings:"System Settings"}[e]||"Dashboard"),"suppliers"===e&&i(),"settings"===e&&$.ajax({url:"api/read.php",type:"GET",dataType:"json",success:function(t){$("#db-status-settings").text("Connected").removeClass("badge-danger").addClass("badge-success"),$("#total-records-settings").text(t.length)},error:function(){$("#db-status-settings").text("Disconnected").removeClass("badge-success").addClass("badge-danger"),$("#total-records-settings").text("N/A")}})}),$("#btn-add-supplier").click(function(){e()}),$("#btn-add-supplier-tab").click(function(){e()}),$(".close-modal, .close-modal-btn").click(function(){$("#supplier-modal").hide()}),$(window).click(function(t){"supplier-modal"==t.target.id&&$("#supplier-modal").hide()}),$("#supplier-form").submit(function(t){t.preventDefault();var e=$("#supplier_id").val(),a=e?"api/update.php":"api/create.php",s={id:e,company_name:$("#company_name").val(),contact_person:$("#contact_person").val(),email:$("#email").val(),phone:$("#phone").val(),address:$("#address").val(),status:$("#status").val()};$.ajax({url:a,type:"POST",data:JSON.stringify(s),contentType:"application/json",success:function(t){$("#supplier-modal").hide(),$("#supplier-form")[0].reset(),c("success",t.message),n(),i()},error:function(t){c("error",t.responseJSON?t.responseJSON.message:"An error occurred")}})}),$(document).on("click",".btn-edit",function(){var t=$(this).data("id");$.ajax({url:"api/get_single.php?id="+t,type:"GET",dataType:"json",success:function(t){$("#supplier_id").val(t.id),$("#company_name").val(t.company_name),$("#contact_person").val(t.contact_person),$("#email").val(t.email),$("#phone").val(t.phone),$("#address").val(t.address),$("#status").val(t.status||"Active"),$("#modal-title").text("Edit Supplier"),$("#supplier-modal").css("display","flex")},error:function(){c("error","Could not fetch supplier details.")}})}),$(document).on("click",".btn-delete",function(){if(confirm("Are you sure you want to delete this supplier?")){var t=$(this).data("id");$.ajax({url:"api/delete.php",type:"POST",data:JSON.stringify({id:t}),contentType:"application/json",success:function(t){c("success",t.message),n(),i()},error:function(t){c("error",t.responseJSON?t.responseJSON.message:"Delete failed")}})}}),$("#search-input").on("keyup",function(){t("#suppliers-table")}),$("#search-input-suppliers").on("keyup",function(){t("#suppliers-table-tab")}),$("#status-filter").on("change",function(){t("#suppliers-table")}),$("#status-filter-suppliers").on("change",function(){t("#suppliers-table-tab")})});
//# sourceMappingURL=script.min.js.map
